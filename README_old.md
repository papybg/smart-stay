üìÇ Smart Stay Agent ‚Äì Project Documentation & History
–ü–æ—Å–ª–µ–¥–Ω–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è: 13.01.2026 –°–æ–±—Å—Ç–≤–µ–Ω–∏–∫: –ë–æ–±–æ –°—Ç–∞—Ç—É—Å: –í –ø—Ä–æ—Ü–µ—Å –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (Phase 2)

1. üèÅ –ö–∞–∫–≤–æ –µ —Å—ä–∑–¥–∞–¥–µ–Ω–æ –¥–æ –º–æ–º–µ–Ω—Ç–∞ (Current State)
–ö—ä–º –¥–Ω–µ—à–Ω–∞ –¥–∞—Ç–∞ –∏–º–∞–º–µ —Ä–∞–±–æ—Ç–µ—â–∞ Basic IoT Control System, –∫–æ—è—Ç–æ —Å–≤—ä—Ä–∑–≤–∞ —É–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–º–µ—Ä.

–ê. –•–∞—Ä–¥—É–µ—Ä–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: –°–º–∞—Ä—Ç –µ–ª–µ–∫—Ç—Ä–æ–º–µ—Ä (Tuya/Smart Life —Å—ä–≤–º–µ—Å—Ç–∏–º), –º–æ–Ω—Ç–∏—Ä–∞–Ω –Ω–∞ DIN —à–∏–Ω–∞.

–ü—Ä–æ–±–ª–µ–º & –†–µ—à–µ–Ω–∏–µ (Critical History):

–°–∏–º–ø—Ç–æ–º: –£—Ä–µ–¥—ä—Ç —Å–µ –∏–∑–∫–ª—é—á–≤–∞—à–µ —Å–∞–º —Å–ª–µ–¥ 20 —Å–µ–∫—É–Ω–¥–∏.

–ü—Ä–∏—á–∏–Ω–∞: –ì—Ä–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω —Ä–µ–∂–∏–º switch_prepayment (–ü—Ä–µ–¥–ø–ª–∞—â–∞–Ω–µ) –≤–º–µ—Å—Ç–æ switch (–†–µ–ª–µ).

–†–µ—à–µ–Ω–∏–µ: –ö–æ–¥—ä—Ç –±–µ—à–µ –ø—Ä–µ–Ω–∞–ø–∏—Å–∞–Ω –¥–∞ –º–∞–Ω–∏–ø—É–ª–∏—Ä–∞ –°–ê–ú–û –ø–∞—Ä–∞–º–µ—Ç—ä—Ä switch (Boolean) –∏ –∏–∑—Ä–∏—á–Ω–æ –¥–∞ –∏–≥–Ω–æ—Ä–∏—Ä–∞/–∏–∑–∫–ª—é—á–≤–∞ switch_prepayment.

–ë. –°–æ—Ñ—Ç—É–µ—Ä–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–¢–µ–∫—É—â–∞)
Backend (Render.com):

Node.js —Å—ä—Ä–≤—ä—Ä —Å Express.

–ò–∑–ø–æ–ª–∑–≤–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ç–∞ @tuya/tuya-connector-nodejs.

–ï–Ω–¥–ø–æ–π–Ω—Ç /toggle: –ü—Ä–æ–≤–µ—Ä—è–≤–∞ —Ç–µ–∫—É—â–∏—è —Å—Ç–∞—Ç—É—Å –Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–º–µ—Ä–∞ –∏ –≥–æ –æ–±—Ä—ä—â–∞ (ON <-> OFF).

Frontend (Vercel):

–°—Ç–∞—Ç–∏—á–µ–Ω HTML —Ñ–∞–π–ª (index.html).

–°—ä–¥—ä—Ä–∂–∞ –µ–¥–∏–Ω –≥–æ–ª—è–º –±—É—Ç–æ–Ω "POWER", –∫–æ–π—Ç–æ –≤–∏–∫–∞ API-—Ç–æ –Ω–∞ Render.

–í–∏–∑—É–∞–ª–∏–∑–∏—Ä–∞ —Å—Ç–∞—Ç—É—Å–∞ (–£—Å–ø–µ—Ö/–ì—Ä–µ—à–∫–∞).

2. üéØ –¶–µ–ª–∏ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞ (The Goal)
–î–∞ —Å–µ —Å—ä–∑–¥–∞–¥–µ –Ω–∞–ø—ä–ª–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ (AI Agent & PMS), –∫–æ—è—Ç–æ —É–ø—Ä–∞–≤–ª—è–≤–∞ Airbnb –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –±–µ–∑ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—Ç–∞ –Ω–∞–º–µ—Å–∞ –Ω–∞ –¥–æ–º–∞–∫–∏–Ω–∞.

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –æ–±—Ö–≤–∞—Ç:
–°–∏–≥—É—Ä–Ω–æ—Å—Ç –∏ –î–æ—Å—Ç—ä–ø:

–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —É–Ω–∏–∫–∞–ª–Ω–∏ 6-—Ü–∏—Ñ—Ä–µ–Ω–∏ –∫–æ–¥–æ–≤–µ –∑–∞ –≤—Ö–æ–¥–Ω–∞ –≤—Ä–∞—Ç–∞ (Smart Lock).

–ö–æ–¥–æ–≤–µ—Ç–µ —Å–∞ –≤–∞–ª–∏–¥–Ω–∏ —Å–∞–º–æ –∑–∞ –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—è—Ç–∞ (Check-in -> Check-out).

–ï–Ω–µ—Ä–≥–∏–π–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç:

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∫–ª—é—á–≤–∞–Ω–µ –Ω–∞ —Ç–æ–∫–∞ (–±–æ–π–ª–µ—Ä, –∫–ª–∏–º–∞—Ç–∏–∫) 2 —á–∞—Å–∞ –ø—Ä–µ–¥–∏ –Ω–∞—Å—Ç–∞–Ω—è–≤–∞–Ω–µ.

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–∫–ª—é—á–≤–∞–Ω–µ 1 —á–∞—Å —Å–ª–µ–¥ –Ω–∞–ø—É—Å–∫–∞–Ω–µ.

AI –î–∏–≥–∏—Ç–∞–ª–µ–Ω –ò–∫–æ–Ω–æ–º (Concierge):

–ö–æ–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –≥–æ—Å—Ç–∏—Ç–µ —á—Ä–µ–∑ —á–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—è–Ω–µ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞ —É—Ä–µ–¥–∏, –°–ü–ê, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ –ª–æ–∫–∞–ª–Ω–∏ –∑–∞–±–µ–ª–µ–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç–∏.

–î–≤—É—Å–ª–æ–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

–ï–∫—Ä–∞–Ω 1 (–ü—É–±–ª–∏—á–µ–Ω): –°–∞–º–æ –≤—Ö–æ–¥ —Å –Ω–æ–º–µ—Ä –Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏—è.

–ï–∫—Ä–∞–Ω 2 (–ó–∞—â–∏—Ç–µ–Ω): –ü–ò–ù –∫–æ–¥ –∑–∞ –≤—Ä–∞—Ç–∞—Ç–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–µ–¥–∏, AI —á–∞—Ç.

3. ‚öôÔ∏è –ö–∞–∫ —â–µ —Å–µ –ø–æ—Å—Ç–∏–≥–Ω–µ (Implementation Plan)
–ü—Ä–æ–µ–∫—Ç—ä—Ç –∏–∑–ø–æ–ª–∑–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∏–ø "Multi-Agent System" (–¢—Ä–∏–º–∞ –∞–≥–µ–Ω—Ç–∏ –≤ –µ–¥–Ω–∞ –æ–ø–∞–∫–æ–≤–∫–∞), —Ö–æ—Å—Ç–≤–∞–Ω–∏ –Ω–∞ –µ–¥–∏–Ω Node.js —Å—ä—Ä–≤—ä—Ä.

–ê. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ–Ω –°—Ç–µ–∫ (Tech Stack)
Backend: Render (Node.js)

Database: Neon (PostgreSQL) ‚Äì –ø–∞–∑–∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ –∏ –∫–æ–¥–æ–≤–µ.

AI Brain: Google Gemini 1.5 Flash (—á—Ä–µ–∑ Google AI Studio API).

IoT Cloud: Tuya IoT Platform (Cloud Development).

Frontend: Vercel (HTML/CSS/JS -> –ø—Ä–µ—Ö–æ–¥ –∫—ä–º React –∑–∞ —Ñ–∏–Ω–∞–ª–Ω–∞—Ç–∞ –≤–µ—Ä—Å–∏—è).

Assets: Cloudinary (–∑–∞ —Å–Ω–∏–º–∫–∏ –∏ –≤–∏–¥–µ–∞).

–ë. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –ê–≥–µ–Ω—Ç–∏—Ç–µ
–ê–≥–µ–Ω—Ç 1: –†–µ—Ü–µ–ø—Ü–∏–æ–Ω–∏—Å—Ç—ä—Ç (Gemini AI)

–ö–æ–º—É–Ω–∏–∫–∏—Ä–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω –µ–∑–∏–∫.

–ò–∑–ø–æ–ª–∑–≤–∞ "System Prompt" (–∑–Ω–∞–Ω–∏–µ –∑–∞ –∫—ä—â–∞—Ç–∞) –∏ RAG.

–ò–∑–ø–æ–ª–∑–≤–∞ Function Calling, –∑–∞ –¥–∞ –≤–∏–∫–∞ –ê–≥–µ–Ω—Ç 2 –∏ 3 (–Ω–µ –ø–∏–ø–∞ –±–∞–∑–∞—Ç–∞ –¥–∏—Ä–µ–∫—Ç–Ω–æ).

–ê–≥–µ–Ω—Ç 2: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ä—Ç (Node.js Logic + SQL)

–ü—Ä–æ–≤–µ—Ä—è–≤–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏—Ç–µ –≤ Neon DB.

–ü–∞–∑–∏ –ø—Ä–∞–≤–∏–ª–∞—Ç–∞: "–ù–µ –ø—É—Å–∫–∞–π —Ç–æ–∫, –∞–∫–æ –Ω–µ –µ –ø–ª–∞—Ç–µ–Ω–æ".

–ê–≥–µ–Ω—Ç 3: –¢–µ—Ö–Ω–∏–∫—ä—Ç (Tuya API)

–ò–∑–ø—ä–ª–Ω—è–≤–∞ "–≥–ª—É—Ö–∏" –∫–æ–º–∞–Ω–¥–∏: "–û—Ç–∫–ª—é—á–∏ –≤—Ä–∞—Ç–∞ ID...", "–ü—É—Å–Ω–∏ —Ç–æ–∫ –Ω–∞ ID...".

–í. –•–∞—Ä–¥—É–µ—Ä–Ω–∞ –°—Ö–µ–º–∞ (The Setup)
–õ–æ–∫–∞—Ü–∏—è: –î–≤–∞ —Å—ä—Å–µ–¥–Ω–∏ –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ (D105 –∏ D106) —Å –æ–±—â –∫–æ—Ä–∏–¥–æ—Ä.

–ú—Ä–µ–∂–∞ (Zigbee Mesh):

–†—É—Ç–µ—Ä + Zigbee Gateway (Multi-mode): –ù–∞–º–∏—Ä–∞—Ç —Å–µ –≤ D105 (–ê–Ω—Ç—Ä–µ, –Ω–∞–¥ –≤—Ä–∞—Ç–∞—Ç–∞).

Smart Lock (Zigbee): –ù–∞–º–∏—Ä–∞ —Å–µ –Ω–∞ –≤—Ä–∞—Ç–∞—Ç–∞ –Ω–∞ D106.

–í—Ä—ä–∑–∫–∞: –°–∏–≥–Ω–∞–ª—ä—Ç –º–∏–Ω–∞–≤–∞ –ø—Ä–µ–∑ –≤—Ä–∞—Ç–∏—Ç–µ (–¥—ä—Ä–≤–æ/–º–µ—Ç–∞–ª) –≤ –∫–æ—Ä–∏–¥–æ—Ä–∞, –∏–∑–±—è–≥–≤–∞–π–∫–∏ –±–∞–Ω–∏—Ç–µ (–µ–∫—Ä–∞–Ω–∏—Ä–∞—â–∏ –ø–ª–æ—á–∫–∏).

–ì. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –ë–∞–∑–∞—Ç–∞ –î–∞–Ω–Ω–∏ (Neon SQL)
–¢–µ–∫—É—â–∞—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –∑–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏:

SQL

CREATE TABLE bookings (
    id SERIAL PRIMARY KEY,
    reservation_code VARCHAR(50) UNIQUE NOT NULL, -- –ö–æ–¥ –æ—Ç Airbnb
    guest_name VARCHAR(100) NOT NULL,
    check_in TIMESTAMP WITH TIME ZONE NOT NULL,
    check_out TIMESTAMP WITH TIME ZONE NOT NULL,
    lock_pin VARCHAR(20), -- –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω –∫–æ–¥ –∑–∞ –±—Ä–∞–≤–∞—Ç–∞
    payment_status VARCHAR(20) DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT NOW()
);
4. üîë –ù–µ–æ–±—Ö–æ–¥–∏–º–∏ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏ (Environment Variables)
–ó–∞ –¥–∞ —Ä–∞–±–æ—Ç–∏ –ø—Ä–æ–µ–∫—Ç—ä—Ç –Ω–∞ –Ω–æ–≤ —Å—ä—Ä–≤—ä—Ä/—á–∞—Ç, —Å–∞ –Ω—É–∂–Ω–∏ —Å–ª–µ–¥–Ω–∏—Ç–µ —Ç–∞–π–Ω–∏ –≤ .env:

–§—Ä–∞–≥–º–µ–Ω—Ç –æ—Ç –∫–æ–¥

# Tuya Configuration
TUYA_ACCESS_ID=...
TUYA_ACCESS_SECRET=...
TUYA_DEVICE_ID=... (Power Meter ID)
TUYA_LOCK_ID=... (Smart Lock ID - Pending)

# Database
DATABASE_URL=... (Neon Connection String)

# AI
GEMINI_API_KEY=... (Google AI Studio Key)

# Server
PORT=10000
–¢–æ–∑–∏ —Ñ–∞–π–ª —Å–ª—É–∂–∏ –∫–∞—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω –∏–∑—Ç–æ—á–Ω–∏–∫ –Ω–∞ –∏—Å—Ç–∏–Ω–∞ (Single Source of Truth) –∑–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ—Ç–æ –Ω–∞ Smart Stay Agent.
