# üéØ RENDER CRON JOBS SETUP

## –ù–æ–≤–∏ Endpoints

–¢–≤–æ–µ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–µ–≥–∞ –∏–º–∞ –¥–≤–∞ –Ω–æ–≤–∏ API endpoints –∑–∞ Render Cron Jobs:

### 1Ô∏è‚É£ Check-in/Check-out Scheduler
```
POST https://your-app.onrender.com/api/reservations/sync
```
**–õ–æ–≥–∏–∫–∞**: –ü—Ä–æ–≤–µ—Ä—è–≤–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ - –≤–∫–ª—é—á–≤–∞ —Ç–æ–∫ –∑–∞ check-in, –∏–∑–∫–ª—é—á–≤–∞ –∑–∞ check-out

### 2Ô∏è‚É£ Gmail Sync (Detective)
```
POST https://your-app.onrender.com/api/email/sync
```
**–õ–æ–≥–∏–∫–∞**: –°–∫–∞–Ω–∏—Ä–∞ Gmail –∑–∞ –Ω–æ–≤–∏ –∏–º–µ–π–ª–∏, –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ Render

### Setup Cron Job #1: Reservations Check-in/Check-out
1. –í Render Dashboard ‚Üí Your Service ‚Üí **Environment**
2. **Create New Cron Job**
   - **Name**: `smart-stay-checkin-checkout`
   - **Schedule**: `*/10 * * * *` (–≤—Å–µ–∫–∏ 10 –º–∏–Ω—É—Ç–∏)
   - **Command**: 
     ```bash
     curl -X POST https://your-app.onrender.com/api/reservations/sync
     ```
   - **Notification Email**: —Ç–≤–æ—è—Ç –∏–º–µ–π–ª (–∑–∞ –≤—ä–∑–º–æ–∂–Ω–∏ –≥—Ä–µ—à–∫–∏)

### Setup Cron Job #2: Gmail Sync
1. **Create another Cron Job**
   - **Name**: `smart-stay-gmail-sync`
   - **Schedule**: `*/15 * * * *` (–≤—Å–µ–∫–∏ 15 –º–∏–Ω—É—Ç–∏)
   - **Command**: 
     ```bash
     curl -X POST https://your-app.onrender.com/api/email/sync
     ```
   - **Notification Email**: —Ç–≤–æ—è—Ç –∏–º–µ–π–ª

---

## ‚úÖ –ü—Ä–µ–¥–∏/–°–ª–µ–¥ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

### –ü–†–ï–î–ò (–ø—Ä–æ–±–ª–µ–º)
- ‚ùå `node-cron` –≤ –æ—Å–Ω–æ–≤–Ω–∏—è –ø—Ä–æ—Ü–µ—Å **24/7**
- ‚ùå –ë—É–¥–∏ Neon –≤—Å–µ–∫–∏ 5, 10, 15 —Å–µ–∫.
- ‚ùå Neon –Ω–∏–∫–æ–≥–∞ –Ω–µ —Å–ø–∏ ‚Üí **–æ—Ç $2-5 CU –ø–æ—Å—Ç–æ—è–Ω–Ω–æ**

### –°–õ–ï–î (—Ä–µ—à–µ–Ω–∏–µ)
- ‚úÖ Render Cron Jobs **–∏–∑–≤—ä–Ω –æ—Å–Ω–æ–≤–Ω–∏—è –ø—Ä–æ—Ü–µ—Å**
- ‚úÖ –û—Å–Ω–æ–≤–Ω–∏—è—Ç app —Å–ø–∏ cuando –Ω—è–º–∞ —Ç—Ä–∞—Ñ–∏–∫
- ‚úÖ Cron —Å–µ –æ–±–≤–∏–≤–∞ —Å–∞–º–æ –∫–æ–≥–¥–∞ Render –≥–æ –∫–∞–∑–≤–∞
- ‚úÖ Neon **0 CU –ø—Ä–∏ –∏–Ω–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç** ‚Üí –ø–æ—á—Ç–∏ –±–µ–∑–ø–ª–∞—Ç–Ω–æ

---

## üìä –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ Render Autoscale

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ü—Ä–µ–¥–∏ | –°–ª–µ–¥ |
|----------|-------|------|
| **0 —Ç—Ä–∞—Ñ–∏–∫, –Ω–æ—â** | 2-5 CU —Ç–æ–∫ (cron –≥–∏ –±—É–¥–∏) | **0 CU** ‚úÖ |
| **App —Å–ø–∏—Ç** | –ù—è–º–æ–≥—ä—â —Å–ø–∞–Ω–µ, –≤—Å–µ–∫–∏ 10s —Å—ä–±—É–∂–¥–∞–Ω–µ | –ò—Å—Ç–∏–Ω—Å–∫–∏ —Å–ø–∞–Ω–µ |
| **–ö–æ—Å—Ç–∞ –Ω–∞ Neon** | $30-50/–º–µ—Å–µ—Ü | ~$2-5/–º–µ—Å–µ—Ü |
| **Render —Å–∫–∞–ª–∞—Ä–∏—Ä–∞–Ω–µ** | –ù–µ –º–æ–≥–∞ –¥–∞ —Å–∫–∞–ª–∏—Ä–∞ –Ω–∞ 0 | –ú–æ–∂–µ –¥–∞ —Å–∫–∞–ª–∏—Ä–∞ –Ω–∞ 0 |

---

## üîç –¢–µ—Å—Ç–≤–∞–Ω–µ

### –õ–æ–∫–∞–ª–Ω–æ —Ç–µ—Å—Ç–≤–∞–Ω–µ (–ø—Ä–µ–¥–∏ deploy):
```bash
# Test reservations sync
curl -X POST http://localhost:10000/api/reservations/sync

# Test email sync
curl -X POST http://localhost:10000/api/email/sync
```

### –ù–∞ Render (—Å–ª–µ–¥ deploy):
–û—Ç–≤–æ—Ä–µ—Ç–µ Service Logs –∏ –≤–∏–∂—Ç–µ –¥–∞–ª–∏ endpoints —Ä–∞–±–æ—Ç—è—Ç:
```
[SCHEDULER] ‚è∞ 2026-02-21T19:30:00Z - Check-in/Check-out sync
[DETECTIVE] üìß Email sync —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω –æ—Ç Render Cron Job
```

---

## üöÄ –î–µ–ø–ª–æ–π

```bash
git add -A
git commit -m "‚ôªÔ∏è Optimize: Move cron to Render Jobs, configure Neon pool for 0 CU idle"
git push origin main
```

Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —â–µ –ø—É—Å–Ω–∞—Ç –Ω–æ–≤–∏—è –∫–æ–¥.

---

## ‚ö†Ô∏è –ü—Ä–∏–ª–∏–∫–∏/–ü—Ä–æ–±–ª–µ–º–∏

### –ê–∫–æ Cron Job –Ω–µ —Å–µ –æ–±–≤–∏–≤–∞:
1. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –ª–æ–≥–æ–≤–µ—Ç–µ –≤ Render ‚Üí **Events** tab
2. –£–±–µ–¥–µ—Ç–µ —á–µ endpoints —Å–∞ `POST`, –Ω–µ `GET`
3. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –∏–º–∞ `API_KEY` –∑–∞—â–∏—Ç–∞? (–Ω–µ —Ç—Ä—è–±–≤–∞ - Render —Å–∞–º –≥–æ –æ–±–≤–∏–∫–∞)

### –ê–∫–æ Neon –æ—â–µ –µ –∞–∫—Ç–∏–≤–µ–Ω:
- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –∏–º–∞ –¥—Ä—É–≥–∏ `setInterval` –∏–ª–∏ `cron` –≤ –∫–æ–¥–∞ (–≤–µ—á–µ –ø—Ä–µ–º–∞—Ö–Ω–∞—Ö–º–µ)
- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ `server.js` —Å–µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞ –±–µ–∑ `initializeScheduler()` (ÂøµÁ•àÎê®, –∑–∞–∫–æ–º–µ–Ω—Ç–∏—Ä–∞–ª–∏ —Å–º–µ)
- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ Neon –ª–æ–≥–æ–≤–µ—Ç–µ –∑–∞ –¥—Ä—É–≥–∏ –∑–∞—è–≤–∫–∏ (–º–æ–∂–µ –¥–∞ —Å–∞ –æ—Ç –¥—Ä—É–≥–∏ —É—Å–ª—É–≥–∏)

---

## ‚ú® Secret –°–ø–æ—Ç–æ–≤

–ö–æ–≥–∞—Ç–æ –≤–∏–¥–∏—Ç–µ —á–µ Neon CU = **0** –ø—Ä–µ–∑ –Ω–æ—â—Ç–∞ **–∏ app —Ä–∞–±–æ—Ç–∏ –Ω–æ—Ä–º–∞–ª–Ω–æ –ø—Ä–∏ —Ç—Ä–∞—Ñ–∏–∫** = —É—Å–ø–µ—Ö! üéâ
