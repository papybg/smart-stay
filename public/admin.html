<!DOCTYPE html>
<html lang="bg"><body style="font-family: sans-serif; max-width: 600px; margin: auto; padding: 20px;">
    <h2>➕ Нова резервация</h2>
    <input type="text" id="guest" placeholder="Име">
    <input type="datetime-local" id="in">
    <input type="datetime-local" id="out">
    <input type="text" id="code" placeholder="Код">
    <button onclick="add()" style="width:100%; padding:10px; background:green; color:white; margin-top:10px;">ЗАПИШИ В NEON</button>
    
    <table id="list" style="width:100%; margin-top:20px; border-collapse: collapse;"></table>

    <script>
        const API = 'https://smart-stay.onrender.com';
        async function add() {
            const body = {
                guest_name: document.getElementById('guest').value,
                check_in: document.getElementById('in').value.replace('T', ' ') + ':00',
                check_out: document.getElementById('out').value.replace('T', ' ') + ':00',
                reservation_code: document.getElementById('code').value
            };
            const res = await fetch(`${API}/add-booking`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(body)});
            const data = await res.json();
            if(data.success) { alert("ПИН: " + data.booking.lock_pin); location.reload(); }
        }
        async function load() {
            const res = await fetch(`${API}/bookings`);
            const data = await res.json();
            document.getElementById('list').innerHTML = data.map(b => `<tr><td>${b.guest_name}</td><td>${new Date(b.check_in).toLocaleString('bg-BG')}</td></tr>`).join('');
        }
        load();
    </script>
</body></html>